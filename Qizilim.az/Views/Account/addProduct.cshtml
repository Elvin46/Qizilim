@model addingProductViewModel
@{
    Layout = "_LayoutStore";
}

@section css {
    <style>
        .ck-content {
            min-height: 250px;
        }

        .photo-viewer {
            display: block !important;
            width: 300px;
            height: 200px;
            background-position: center;
            background-size: cover;
            object-fit: cover;
            background-image: url('/photouploads/images/file-upload.jpg');
            cursor: pointer;
        }

        #file {
            display: block;
        }
    </style>
}

<div class="product-add-div">
    <h3 class="add-prdct-h3">Elan əlavə et</h3>
    <form class="product-add-form" method="post" enctype="multipart/form-data">
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        @*<label for="file1" class="control-label">Sekil</label> <br />*@
        @*<div class="form-group">
                <label class="photo-viewer" id="file-viewer" for="files" class="control-label"></label>
                <input name="files" id="file" type="file" class="form-control" onchange="readFile(this)" />
                <span asp-validation-for="files" class="text-danger"></span>
            </div>*@
        <div class="product-detail-content">
            <div class="product-detail-header">
                <label asp-for="Name">Elan başlığı</label>
            </div>
            <div class="product-deatil-it">
                <input asp-for="Name" type="text" class="add" name="Name" id="" maxlength="50" />
                <span asp-validation-for="Name" class="text-danger"></span>

            </div>
        </div>

        <div class="add-img-ads">
            <label for="images" class="drop-container">
                <span class="drop-title">Şəkil əlavə et</span>
                (max : 12)
                <input name="files" id="images" type="file" class="form-control" onchange="readFile(this)" multiple />
                @*<input name="files" asp-for="files" type="file"
                    class="file-field"
                    id="images"
                    accept="image/*"
                    multiple
                    required />*@
                
            </label>
            <span asp-validation-for="files" class="text-danger"></span>
            <div class="add-img-container">
                <input asp-for="MainPhoto" name="MainPhoto" class="main_file" style="display:none" type="text"/>
            </div>
        </div>
        <div class="product-detail-content">
            <div class="product-detail-header">
                <label asp-for="Kateqoriya">Kateqoriya</label>
            </div>
            <div class="product-deatil-it">
                <select asp-for="Kateqoriya" name="Kateqoriya" class="form-select">
                    <option selected disabled>Seçilməyib</option>
                    @foreach (var item in ViewBag.Kateqoriya)
                    {
                        <option>@item.Name</option>
                    }
                </select>
            <span asp-validation-for="Kateqoriya" class="text-danger"></span>
            </div>
        </div>
        <div class="product-detail-content" id="addFormProb">
            <div class="product-detail-header">
                <label asp-for="EyarOlcusuId">Əyyar:</label>
            </div>

            <div class="product-deatil-it">
                <select asp-for="EyarOlcusuId" name="EyarOlcusuId" class="form-select">
                    <option selected disabled value="0">Seçilməyib</option>
                    @foreach (var item in ViewBag.Eyyar)
                    {
                        <option value="@item.Id">@item.EyarOlcusu</option>
                    }
                </select>
                <span asp-validation-for="EyarOlcusuId" class="text-danger"></span>

            </div>
        </div>
        <div class="product-detail-content" id="addFormProb">
            <div class="product-detail-header">
                <label asp-for="ColorsId">Qızıl rəngi:</label>

            </div>

            <div class="product-deatil-it">
                <select asp-for="ColorsId" name="ColorsId" class="form-select">
                    <option selected disabled value="0">Seçilməyib</option>
                    @foreach (var item in ViewBag.Colors)
                    {
                        <option value="@item.Id">@item.Name</option>
                    }
                </select>
                <span asp-validation-for="ColorsId" class="text-danger"></span>

            </div>
        </div>
        <div class="product-detail-content" id="addFormWeight">
            <div class="product-detail-header">
                <label asp-for="Weight">Çəki</label>

            </div>
            <div class="product-deatil-it">
                <input step="0.1" asp-for="Weight" type="number" name="Weight" id="" class="add" />
                <label class="detail-form">
                    ,qram
                </label>

            </div>
            <span asp-validation-for="Weight" class="text-danger"></span>
        </div>
        <div class="product-detail-content">
            <div class="product-detail-header">
                <label>
                    <input asp-for="HasDiamond" type="checkbox"
                           name="HasDiamond"
                           id="diamonCheck"
                           onclick="EnableDisableTextBox(this)" />
                    Brilliant
                </label>

            </div>
            <div class="product-deatil-it">
                <input asp-for="CountDiamond" type="number" name="CountDiamond" id="addDiamondCount" class="add" disabled="disabled" />
                <label class="detail-form"> ,ct</label>

            </div>
        </div>
        <div class="product-detail-content">
            <div class="product-detail-header">
                <label asp-for="aboutProduct">Ətraflı məlumat</label>

            </div>
            <div class="product-deatil-it">
                <textarea asp-for="aboutProduct" name="aboutProduct" id="" cols="30" rows="10"></textarea>
                <span asp-validation-for="aboutProduct" class="text-danger"></span>

            </div>
        </div>
        <div class="product-detail-content">
            <div class="product-detail-header">
                <label asp-for="Price">Qiymət</label>

            </div>
            <div class="product-deatil-it">
                <input asp-for="Price" type="Price" name="Price" id="" />
                <label class="detail-form">
                    ,AZN
                </label>
            </div>
            <span asp-validation-for="Price" class="text-danger"></span>
        </div>
        <div class="add-prdct-btn-div">
            <input type="submit" value="Elani əlavə et" class="add-prdct-btn" />
        </div>
    </form>

</div>

@section js {
    <script>

        function readFile(input) {
            let file = input.files[0];
            let reader = new FileReader();

            reader.onload = function () {
                $('#file-viewer').css('background-image', `url(${reader.result})`);
            };

            reader.onerror = function () {
                console.log(reader.error);
            };

            reader.readAsDataURL(file);
        }
        const imageInput = document.getElementById("images");
        const mainFile = document.querySelector(".main_file");
        var ortukEt;
        const addImgContainer = document.querySelector(".add-img-container");
        let arr = []
        imageInput.addEventListener('change', (e) => {
            arr = Object.values(e.target.files)
            console.log(arr);
            var num = 0;
            arr.forEach((it, index) => {
                const div = document.createElement("div")
                div.classList.add("cover_image")
                const button = document.createElement("button");
                button.innerHTML = "Örtük et";
                button.classList.add("do_cover");
                button.setAttribute("id", `${num}`)
                num++;
                button.type = "button";
                button.onclick = function () {
                    console.log("salam");
                    console.log(arr[index].name);
                    mainFile.innerHTML = arr[index].name;
                    mainFile.value = arr[index].name;
                };
                const image = document.createElement("img");
                const reader = new FileReader();
                reader.addEventListener("load", () => {
                    image.src = reader.result;
                    div.appendChild(image);
                    div.appendChild(button);
                    addImgContainer.appendChild(div);
                });
                reader.readAsDataURL(e.target.files[index]);


            })
            ortukEt = document.getElementsByClassName("do_cover");
        })
    </script>
}